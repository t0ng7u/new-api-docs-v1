---
title: Token Management Module
---

<Callout type="info" title="Feature Description">
The API prefix is uniformly http(s)://`<your-domain>`
</Callout>

    HTTPS should be used in production environments to ensure authentication tokens. HTTP is only recommended for development environments.

    A complete management system for user API Tokens. It supports features such as Token creation, update, deletion, and batch operations. It includes fine-grained controls like model limits, IP restrictions, quota management, and expiration times. This is the core data source for the frontend Token page.

## üîê User Authentication

### Get All Tokens

- **Interface Name**: Get All Tokens
- **HTTP Method**: GET
- **Path**: `/api/token/`
- **Authentication Required**: User
- **Function Description**: Paginate and retrieve all Token lists for the current user

üí° Request Example:

```
const response = await fetch('/api/token/?p=1&size=20', {
  method: 'GET',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer your_user_token',
    'New-Api-User': 'your_user_id'
  }
});
const data = await response.json();
```

‚úÖ Successful Response Example:

```
{
  "success": true,
  "message": "",
  "data": {
    "items": [
      {
        "id": 1,
        "name": "API Token",
        "key": "`<YOUR_API_KEY>`",
        "status": 1,
        "remain_quota": 1000000,
        "unlimited_quota": false,
        "expired_time": 1640995200,
        "created_time": 1640908800,
        "accessed_time": 1640995000
      }
    ],
    "total": 5,
    "page": 1,
    "page_size": 20
  }
}
```

‚ùó Failed Response Example:

```
{
  "success": false,
  "message": "Failed to search Token list"
}
```

üßæ Field Description:

- `p` (Number): Page number, defaults to 1
- `size` (Number): Items per page, defaults to 20
- `items` (Array): List of Token information
- `total` (Number): Total number of Tokens
- `page` (Number): Current page number
- `page_size` (Number): Items per page

### Search Tokens

- **Interface Name**: Search Tokens
- **HTTP Method**: GET
- **Path**: `/api/token/search`
- **Authentication Required**: User
- **Function Description**: Search user Tokens by keyword and Token value

üí° Request Example:

```
const response = await fetch('/api/token/search?keyword=api&token=sk-123', {
  method: 'GET',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer your_user_token',
    'New-Api-User': 'your_user_id'
  }
});
const data = await response.json();
```

‚úÖ Successful Response Example:

```
{
  "success": true,
  "message": "",
  "data": [
    {
      "id": 1,
      "name": "API Token",
      "key": "sk-your-token-placeholder",
      "status": 1,
      "remain_quota": 1000000
    }
  ]
}
```

‚ùó Failed Response Example:

```
{
  "success": false,
  "message": "Failed to search Token"
}
```

üßæ Field Description:

- `keyword` (String): Search keyword, matches Token name
- `token` (String): Token value search, supports partial matching

### Get Single Token

- **Interface Name**: Get Single Token
- **HTTP Method**: GET
- **Path**: `/api/token/:id`
- **Authentication Required**: User
- **Function Description**: Get detailed information for a specified Token

üí° Request Example:

```
const response = await fetch('/api/token/123', {
  method: 'GET',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer your_user_token',
    'New-Api-User': 'your_user_id'
  }
});
const data = await response.json();
```

‚úÖ Successful Response Example:

```
{
  "success": true,
  "message": "",
  "data": {
    "id": 123,
    "name": "API Token",
    "key": "sk-your-token-placeholder",
    "status": 1,
    "remain_quota": 1000000,
    "unlimited_quota": false,
    "model_limits_enabled": true,
    "model_limits": "gpt-3.5-turbo,gpt-4",
    "allow_ips": "192.168.1.1,10.0.0.1",
    "group": "default",
    "expired_time": 1640995200,
    "created_time": 1640908800,
    "accessed_time": 1640995000
  }
}
```

‚ùó Failed Response Example:

```
{
  "success": false,
  "message": "Token does not exist"
}
```

üßæ Field Description:

`id` (Number): Token ID, passed via URL path

### Create Token

- **Interface Name**: Create Token
- **HTTP Method**: POST
- **Path**: `/api/token/`
- **Authentication Required**: User
- **Function Description**: Create new API Tokens, supports batch creation

üí° Request Example:

```
const response = await fetch('/api/token/', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer your_user_token',
    'New-Api-User': 'your_user_id'
  },
  body: JSON.stringify({
    name: "My API Token",
    expired_time: 1640995200,
    remain_quota: 1000000,
    unlimited_quota: false,
    model_limits_enabled: true,
    model_limits: ["gpt-3.5-turbo", "gpt-4"],
    allow_ips: "192.168.1.1,10.0.0.1",
    group: "default"
  })
});
const data = await response.json();
```

‚úÖ Successful Response Example:

```
{
  "success": true,
  "message": ""
}
```

‚ùó Failed Response Example:

```
{
  "success": false,
  "message": "Token name too long"
}
```

üßæ Field Description:

- `name` (String): Token name, maximum length 30 characters
- `expired_time` (Number): Expiration timestamp, -1 means never expires
- `remain_quota` (Number): Remaining quota
- `unlimited_quota` (Boolean): Whether quota is unlimited
- `model_limits_enabled` (Boolean): Whether model limits are enabled
- `model_limits` (Array): List of allowed models
- `allow_ips` (String): Allowed IP addresses, comma-separated
- `group` (String): Associated group

### Update Token

- **Interface Name**: Update Token
- **HTTP Method**: PUT
- **Path**: `/api/token/`
- **Authentication Required**: User
- **Function Description**: Update Token configuration, supports status toggling and full updates

üí° Request Example (Full Update):

```
const response = await fetch('/api/token/', {
  method: 'PUT',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer your_user_token',
    'New-Api-User': 'your_user_id'
  },
  body: JSON.stringify({
    id: 123,
    name: "Updated Token",
    expired_time: 1640995200,
    remain_quota: 2000000,
    unlimited_quota: false,
    model_limits_enabled: true,
    model_limits: ["gpt-3.5-turbo", "gpt-4"],
    allow_ips: "192.168.1.1",
    group: "vip"
  })
});
const data = await response.json();
```

üí° Request Example (Status Update Only):

```
const response = await fetch('/api/token/?status_only=true', {
  method: 'PUT',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer your_user_token',
    'New-Api-User': 'your_user_id'
  },
  body: JSON.stringify({
    id: 123,
    status: 1
  })
});
const data = await response.json();
```

‚úÖ Successful Response Example:

```
{
  "success": true,
  "message": "",
  "data": {
    "id": 123,
    "name": "Updated Token",
    "status": 1
  }
}
```

‚ùó Failed Response Example:

```
{
  "success": false,
  "message": "Token has expired and cannot be enabled. Please modify the token expiration time or set it to never expire first."
}
```

üßæ Field Description:

- `id` (Number): Token ID, required
- `status_only` (Query Parameter): Whether to update status only
- Other fields are the same as the Create Token interface and are all optional

### Delete Token

- **Interface Name**: Delete Token
- **HTTP Method**: DELETE
- **Path**: `/api/token/:id`
- **Authentication Required**: User
- **Function Description**: Delete the specified Token

üí° Request Example:

```
const response = await fetch('/api/token/123', {
  method: 'DELETE',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer your_user_token',
    'New-Api-User': 'your_user_id'
  }
});
const data = await response.json();
```

‚úÖ Successful Response Example:

```
{
  "success": true,
  "message": ""
}
```

‚ùó Failed Response Example:

```
{
  "success": false,
  "message": "Token does not exist"
}
```

üßæ Field Description:

`id` (Number): Token ID, passed via URL path

### Batch Delete Tokens

- **Interface Name**: Batch Delete Tokens
- **HTTP Method**: POST
- **Path**: `/api/token/batch`
- **Authentication Required**: User
- **Function Description**: Delete multiple Tokens in a batch

üí° Request Example:

```
const response = await fetch('/api/token/batch', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer your_user_token',
    'New-Api-User': 'your_user_id'
  },
  body: JSON.stringify({
    ids: [1, 2, 3, 4, 5]
  })
});
const data = await response.json();
```

‚úÖ Successful Response Example:

```
{
  "success": true,
  "message": "",
  "data": 5
}
```

‚ùó Failed Response Example:

```
{
  "success": false,
  "message": "Parameter error"
}
```

üßæ Field Description:

- `ids` (Array): List of Token IDs to delete, required and cannot be empty
- `data` (Number): Number of Tokens successfully deleted